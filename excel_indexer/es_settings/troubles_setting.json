{
  "similarity": {
    "scripted_tfidf": {
      "type": "scripted",
      "weight_script": {
        "source": "double idf = Math.log((field.docCount+1.0)/(term.docFreq+1.0)) + 1.0; return query.boost * idf;"
      },
      "script": {
        "source": "double tf = Math.sqrt(doc.freq); double norm = 1/Math.sqrt(doc.length); return weight * tf * norm;"
      }
    }
  },
  "analysis": {
    "analyzer": {
      "troubles_analyzer": {
        "type": "custom",
        "char_filter": [
          "icu_normalizer"
        ],
        "tokenizer": "kuromoji_tokenizer",
        "filter": [
          "kuromoji_baseform",
          "kuromoji_part_of_speech",
          "ja_stop",
          "kuromoji_number",
          "kuromoji_stemmer"
        ]
      }
    }
  }
}